#include <iostream>
#include <cmath>
#include <algorithm>
#include <vector>

#include "gerg.hpp"
#include "dartsflash/global/global.hpp"

namespace gerg2008 {
    // DATA FROM GERG-2008 (Kunz and Wagner [2012])
    // Critical parameters, Table A.5
    std::unordered_map<std::string, double> rho_ci = {
        {"C1", 10.139342719}, {"N2", 11.1839}, {"CO2", 10.624978698}, {"C2", 6.870854540}, {"C3", 5.000043088},
        {"nC4", 3.920016792}, {"iC4", 3.860142940}, {"nC5", 3.215577588}, {"iC5", 3.271}, {"nC6", 2.705877875}, 
        {"nC7", 2.315324434}, {"nC8", 2.056404127}, {"nC9", 1.81}, {"nC10", 1.64}, 
        {"H2", 14.94}, {"O2", 13.63}, {"CO", 10.85}, {"H2O", 17.873716090}, {"H2S", 10.19}, {"He", 17.399}, {"Ar", 13.407429659},  
    };  // critical density [mol dm-3]
    std::unordered_map<std::string, double> T_ci = {
        {"C1", 190.564}, {"N2", 126.192}, {"CO2", 304.1282}, {"C2", 305.322}, {"C3", 369.825}, 
        {"nC4", 425.125}, {"iC4", 407.817}, {"nC5", 469.7}, {"iC5", 460.35}, {"nC6", 507.82}, 
        {"nC7", 540.13}, {"nC8", 569.32}, {"nC9", 594.55}, {"nC10", 617.7},
        {"H2", 33.19}, {"O2", 154.595}, {"CO", 132.86}, {"H2O", 647.096}, {"H2S", 373.1}, {"He", 5.1953}, {"Ar", 150.687},  
    };  // critical temperature [K]
    std::unordered_map<std::string, double> MW_i = {
        {"C1", 16.04246}, {"N2", 28.0134}, {"CO2", 44.0095}, {"C2", 30.06904}, {"C3", 44.09562}, 
        {"nC4", 58.1222}, {"iC4", 58.1222}, {"nC5", 72.14878}, {"iC5", 72.14878}, {"nC6", 86.17536}, 
        {"nC7", 100.20194}, {"nC8", 114.22852}, {"nC9", 128.2551}, {"nC10", 142.28168},
        {"H2", 2.01588}, {"O2", 31.9988}, {"CO", 28.0101}, {"H2O", 18.01528}, {"H2S", 34.08088}, {"He", 4.002602}, {"Ar", 39.948},  
    };  // molecular weight [g mol-1]

    // Table A.1
    std::unordered_map<std::string, std::vector<double>> n_o_oi = {
        {"C1", {19.597508817, -83.959667892, 3.00088, 0.76315, 0.00460, 8.74432, -4.46921}},
        {"N2", {11.083407489, -22.202102428, 2.50031, 0.13732, -0.14660, 0.90066, 0.}},
        {"CO2", {11.925152758, -16.118762264, 2.50002, 2.04452, -1.06044, 2.03366, 0.01393}},
        {"C2", {24.675437527, -77.425313760, 3.00263, 4.33939, 1.23722, 13.19740, -6.01989}},
        {"C3", {31.602908195, -84.463284382, 3.02939, 6.60569, 3.19700, 19.19210, -8.37267}},
        {"nC4", {20.884143364, -91.638478026, 3.33944, 9.44893, 6.89406, 24.46180, 14.78240}},
        {"iC4", {20.413726078, -94.467620036, 3.06714, 8.97575, 5.25156, 25.14230, 16.13880}},
        {"nC5", {14.536611217, -89.919548319, 3.00000, 8.95043, 21.83600, 33.40320, 0.}},
        {"iC5", {15.449907693, -101.298172792, 3.00000, 11.76180, 20.11010, 33.16880, 0.}},
        {"nC6", {14.345969349, -96.165722367, 3.00000, 11.69770, 26.81420, 38.61640, 0.}},
        {"nC7", {15.063786601, -97.345252349, 3.00000, 13.72660, 30.47070, 43.55610, 0.}},
        {"nC8", {15.864687161, -97.370667555, 3.00000, 15.68650, 33.80290, 48.17310, 0.}},
        {"nC9", {16.313913248, -102.160247463, 3.00000, 18.02410, 38.12350, 53.34150, 0.}},
        {"nC10", {15.870791919, -108.858547525, 3.00000, 21.00690, 43.49310, 58.36570, 0.}},
        {"H2", {13.796443393, -175.864487294, 1.47906, 0.95806, 0.45444, 1.56039, -1.37560}},
        {"O2", {10.001843586, -14.996095135, 2.50146, 1.07558, 1.01334, 0., 0.}},
        {"CO", {10.813340744, -19.834733959, 2.50055, 1.02865, 0.00493, 0., 0.}},
        {"H2O", {8.203520690, -11.996306443, 3.00392, 0.01059, 0.98763, 3.06904, 0.}},
        {"H2S", {9.336197742, -16.266508995, 3.00000, 3.11942, 1.00243, 0., 0.}},
        {"He", {13.628409737, -143.470759602, 1.50000, 0., 0., 0., 0.}},
        {"Ar", {8.316631500, -4.946502600, 1.50000, 0., 0., 0., 0.}},
    };
    std::unordered_map<std::string, std::vector<double>> th_o_oi = {
        {"C1", {0., 0., 0., 4.306474465, 0.936220902, 5.577233895, 5.722644361}},
        {"N2", {0., 0., 0., 5.251822620, -5.393067706, 13.788988208, 0.}},
        {"CO2", {0., 0., 0., 3.022758166, -2.844425476, 1.589964364, 1.121596090}},
        {"C2", {0., 0., 0., 1.831882406, 0.731306621, 3.378007481, 3.508721939}},
        {"C3", {0., 0., 0., 1.297521801, 0.543210978, 2.583146083, 2.777773271}},
        {"nC4", {0., 0., 0., 1.101487798, 0.431957660, 4.502440459, 2.124516319}},
        {"iC4", {0., 0., 0., 1.074673199, 0.485556021, 4.671261865, 2.191583480}},
        {"nC5", {0., 0., 0., 0.380391739, 1.789520971, 3.777411113, 0.}},
        {"iC5", {0., 0., 0., 0.635392636, 1.977271641, 4.169371131, 0.}},
        {"nC6", {0., 0., 0., 0.359036667, 1.691951873, 3.596924107, 0.}},
        {"nC7", {0., 0., 0., 0.314348398, 1.548136560, 3.259326458, 0.}},
        {"nC8", {0., 0., 0., 0.279143540, 1.431644769, 2.973845992, 0.}},
        {"nC9", {0., 0., 0., 0.263819696, 1.370586158, 2.848860483, 0.}},
        {"nC10", {0., 0., 0., 0.267034159, 1.353835195, 2.833479035, 0.}},
        {"H2", {0., 0., 0., 6.891654113, 9.847634830, 49.765290750, 50.367279301}},
        {"O2", {0., 0., 0., 14.461722565, 7.223325463, 0., 0.}},
        {"CO", {0., 0., 0., 11.669802800, 5.302762306, 0., 0.}},
        {"H2O", {0., 0., 0., 0.415386589, 1.763895929, 3.874803739, 0.}},
        {"H2S", {0., 0., 0., 4.914580541, 2.270653980, 0., 0.}},
        {"He", {0., 0., 0., 0., 0., 0., 0.}},
        {"Ar", {0., 0., 0., 0., 0., 0., 0.}},
    };

    // Table A.2/A.3/A.4
    std::unordered_map<std::string, int> K_pol_i = {
        {"C1", 6}, {"N2", 6}, {"C2", 6},
        {"CO2", 4}, {"H2", 5}, {"H2O", 7}, {"He", 4},
        {"C3", 6}, {"nC4", 6}, {"iC4", 6}, {"nC5", 6}, {"iC5", 6}, {"nC6", 6}, {"nC7", 6}, 
        {"nC8", 6}, {"nC9", 6}, {"nC10", 6}, {"O2", 6}, {"CO", 6}, {"H2S", 6}, {"Ar", 6},
    };
    std::unordered_map<std::string, int> K_exp_i = {
        {"C1", 18}, {"N2", 18}, {"C2", 18},
        {"CO2", 18}, {"H2", 9}, {"H2O", 9}, {"He", 8},
        {"C3", 6}, {"nC4", 6}, {"iC4", 6}, {"nC5", 6}, {"iC5", 6}, {"nC6", 6}, {"nC7", 6}, 
        {"nC8", 6}, {"nC9", 6}, {"nC10", 6}, {"O2", 6}, {"CO", 6}, {"H2S", 6}, {"Ar", 6},
    };

    std::unordered_map<std::string, std::vector<double>> n_oi = {
        {"C1", {0.57335704239162, -0.16760687523730e1, 0.23405291834916, -0.21947376343441, 0.16369201404128e-1, 0.15004406389280e-1, 
                0.98990489492918e-1, 0.58382770929055, -0.74786867560390, 0.30033302857974, 0.20985543806568, -0.18590151133061e-1,
                -0.15782558339049, 0.12716735220791, -0.32019743894346e-1, -0.68049729364536e-1, 0.24291412853736e-1, 0.51440451639444e-2,
                -0.19084949733532e-1, 0.55229677241291e-2, -0.44197392976085e-2, 0.40061416708429e-1, -0.33752085907575e-1, -0.25127658213357e-2}},
        {"N2", {0.59889711801201, -0.16941557480731e1, 0.24579736191718, -0.23722456755175, 0.17954918715141e-1, 0.14592875720215e-1,
                0.10008065936206, 0.73157115385532, -0.88372272336366, 0.31887660246708, 0.20766491728799, -0.19379315454158e-1,
                -0.16936641554983, 0.13546846041701, -0.33066712095307e-1, -0.60690817018557e-1, 0.12797548292871e-1, 0.58743664107299e-2,
                -0.18451951971969e-1, 0.47226622042472e-2, -0.52024079680599e-2, 0.43563505956635e-1, -0.36251690750939e-1, -0.28974026866543e-2}},
        {"C2", {0.63596780450714, -0.17377981785459e1, 0.28914060926272, -0.33714276845694, 0.22405964699561e-1, 0.15715424886913e-1,
                0.11450634253745, 0.10612049379745e1, -0.12855224439423e1, 0.39414630777652, 0.31390924682041, -0.21592277117247e-1,
                -0.21723666564905, -0.28999574439489, 0.42321173025732, 0.46434100259260e-1, -0.13138398329741, 0.11492850364368e-1,
                -0.33387688429909e-1, 0.15183171583644e-1, -0.47610805647657e-2, 0.46917166277885e-1, -0.39401755804649e-1, -0.32569956247611e-2}},
        {"CO2", {0.52646564804653, -0.14995725042592e1, 0.27329786733782, 0.12949500022786,
                0.15404088341841, -0.58186950946814, -0.18022494838296, -0.95389904072812e-1, -0.80486819317679e-2, -0.35547751273090e-1,
                -0.28079014882405, -0.82435890081677e-1, 0.10832427979006e-1, -0.67073993161097e-2, -0.46827907600524e-2, -0.28359911832177e-1,
                0.19500174744098e-1, -0.21609137507166, 0.43772794926972, -0.22130790113593, 0.15190189957331e-1, -0.15380948953300e-1}},
        {"H2", {0.53579928451252e1, -0.62050252530595e1, 0.13830241327086, -0.71397954896129e-1, 0.15474053959733e-1,
                -0.14976806405771, -0.26368723988451e-1, 0.56681303156066e-1, -0.60063958030436e-1, -0.45043942027132,
                0.42478840244500, -0.21997640827139e-1, -0.10499521374530e-1, -0.28955902866816e-2}},
        {"H2O", {0.82728408749586, -0.18602220416584e1, -0.11199009613744e1, 0.15635753976056, 0.87375844859025, -0.36674403715731, 0.53987893432436e-1,
                0.10957690214499e1, 0.53213037828563e-1, 0.13050533930825e-1, -0.41079520434476, 0.14637443344120, 
                -0.55726838623719e-1, -0.11201774143800e-1, -0.66062758068099e-2, 0.46918522004538e-2}},
        {"He", {-0.45579024006737, 0.12516390754925e1, -0.15438231650621e1, 0.20467489707221e-1,
                -0.34476212380781, -0.20858459512787e-1, 0.16227414711778e-1, -0.57471818200892e-1, 
                0.19462416430715e-1, -0.33295680123020e-1, -0.10863577372367e-1, -0.22173365245954e-1}},
        {"C3", {0.10403973107358e1, -0.28318404081403e1, 0.84393809606294, -0.76559591850023e-1, 0.94697373057280e-1, 0.24796475497006e-3,
                0.27743760422870, -0.43846000648377e-1, -0.26991064784350, -0.69313413089860e-1, -0.29632145981653e-1, 0.14040126751380e-1}},
        {"nC4", {0.10626277411455e1, -0.28620951828350e1, 0.88738233403777, -0.12570581155345, 0.10286308708106, 0.25358040602654e-3,
                0.32325200233982, -0.37950761057432e-1, -0.32534802014452, -0.79050969051011e-1, -0.20636720547775e-1, 0.57053809334750e-2}},
        {"iC4", {0.10429331589100e1, -0.28184272548892e1, 0.86176232397850, -0.10613619452487, 0.98615749302134e-1, 0.23948208682322e-3,
                0.30330004856950, -0.41598156135099e-1, -0.29991937470058, -0.80369342764109e-1, -0.29761373251151e-1, 0.13059630303140e-1}},
        {"nC5", {0.10968643098001e1, -0.29988888298061e1, 0.99516886799212, -0.16170708558539, 0.11334460072775, 0.26760595150748e-3,
                0.40979881986931, -0.40876423083075e-1, -0.38169482469447, -0.10931956843993, -0.32073223327990e-1, 0.16877016216975e-1}},
        {"iC5", {0.10963e1, -0.30402e1, 0.10317e1, -0.15410, 0.11535, 0.29809e-3, 0.39571, -0.45881e-1, -0.35804, -0.10107, -0.35484e-1, 0.18156e-1}},
        {"nC6", {0.10553238013661e1, -0.26120615890629e1, 0.76613882967260, -0.29770320622459, 0.11879907733358, 0.27922861062617e-3,
                0.46347589844105, 0.11433196980297e-1, -0.48256968738131, -0.93750558924659e-1, -0.67273247155994e-2, -0.51141583585428e-2}},
        {"nC7", {0.10543747645262e1, -0.26500681506144e1, 0.81730047827543, -0.30451391253428, 0.12253868710800, 0.27266472743928e-3,
                0.49865825681670, -0.71432815084176e-3, -0.54236895525450, -0.13801821610756, -0.61595287380011e-2, 0.48602510393022e-3}},
        {"nC8", {0.10722544875633e1, -0.24632951172003e1, 0.65386674054928, -0.36324974085628, 0.12713269626764, 0.30713572777930e-3,
                0.52656856987540, 0.19362862857653e-1, -0.58939426849155, -0.14069963991934, -0.78966330500036e-2, 0.33036597968109e-2}},
        {"nC9", {0.11151e1, -0.27020e1, 0.83416, -0.38828, 0.13760, 0.28185e-3, 0.62037, 0.15847e-1, -0.61726, -0.15043, -0.12982e-1, 0.44325e-2}},
        {"nC10", {0.10461e1, -0.24807e1, 0.74372, -0.52579, 0.15315, 0.32865e-3, 0.84178, 0.55424e-1, -0.73555, -0.18507, -0.20775e-1, 0.12335e-1}},
        {"O2", {0.88878286369701, -0.24879433312148e1, 0.59750190775886, 0.96501817061881e-2, 0.71970428712770e-1, 0.22337443000195e-3,
                0.18558686391474, -0.38129368035760e-1, -0.15352245383006, -0.26726814910919e-1, -0.25675298677127e-1, 0.95714302123668e-2}},
        {"CO", {0.90554, -0.24515e1, 0.53149, 0.24173e-1, 0.72156e-1, 0.18818e-3, 0.19405, -0.43268e-1, -0.12778, -0.27896e-1, -0.34154e-1, 0.16329e-1}},
        {"H2S", {0.87641, -0.20367e1, 0.21634, -0.50199e-1, 0.66994e-1, 0.19076e-3, 0.20227, -0.45348e-2, -0.22230, -0.34714e-1, -0.14885e-1, 0.74154e-2}},
        {"Ar", {0.85095714803969, -0.24003222943480e1, 0.54127841476466, 0.16919770692538e-1, 0.68825965019035e-1, 0.21428032815338e-3, 
                0.17429895321992, -0.33654495604194e-1, -0.13526799857691, -0.16387350791552e-1, -0.24987666851475e-1, 0.88769204815709e-2}},
    };
    std::unordered_map<std::string, std::vector<int>> c_oi = {
        {"C1", {0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 6, 6, 6, 6}},
        {"N2", {0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 6, 6, 6, 6}},
        {"C2", {0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 6, 6, 6, 6}},
        {"CO2", {0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 3, 3, 3, 5, 5, 5, 6, 6}},
        {"H2", {0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 3, 3, 5}},
        {"H2O", {0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 5, 5}},
        {"He", {0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 3, 3}},
        {"C3", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"nC4", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"iC4", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"nC5", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"iC5", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"nC6", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"nC7", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"nC8", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"nC9", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"nC10", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"O2", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"CO", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"H2S", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
        {"Ar", {0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3}},
    };
    std::unordered_map<std::string, std::vector<int>> d_oi = {
        {"C1", {1, 1, 2, 2, 4, 4, 1, 1, 1, 2, 3, 6, 2, 3, 3, 4, 4, 2, 3, 4, 5, 6, 6, 7}},
        {"N2", {1, 1, 2, 2, 4, 4, 1, 1, 1, 2, 3, 6, 2, 3, 3, 4, 4, 2, 3, 4, 5, 6, 6, 7}},
        {"C2", {1, 1, 2, 2, 4, 4, 1, 1, 1, 2, 3, 6, 2, 3, 3, 4, 4, 2, 3, 4, 5, 6, 6, 7}},
        {"CO2", {1, 1, 2, 3, 3, 3, 4, 5, 6, 6, 1, 4, 1, 1, 3, 3, 4, 5, 5, 5, 5, 5}},
        {"H2", {1, 1, 2, 2, 4, 1, 5, 5, 5, 1, 1, 2, 5, 1}},
        {"H2O", {1, 1, 1, 2, 2, 3, 4, 1, 5, 5, 1, 2, 4, 4, 1, 1}},
        {"He", {1, 1, 1, 4, 1, 3, 5, 5, 5, 2, 1, 2}},
        {"C3", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"nC4", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"iC4", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"nC5", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"iC5", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"nC6", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"nC7", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"nC8", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"nC9", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"nC10", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"O2", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"CO", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"H2S", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
        {"Ar", {1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4}},
    };
    std::unordered_map<std::string, std::vector<double>> t_oi = {
        {"C1", {0.125, 1.125, 0.375, 1.125, 0.625, 1.500, 0.625, 2.625, 2.750, 2.125, 2.000, 1.750,
                4.500, 4.750, 5.000, 4.000, 4.500, 7.500, 14.00, 11.50, 26.00, 28.00, 30.00, 16.00}},
        {"N2", {0.125, 1.125, 0.375, 1.125, 0.625, 1.500, 0.625, 2.625, 2.750, 2.125, 2.000, 1.750,
                4.500, 4.750, 5.000, 4.000, 4.500, 7.500, 14.00, 11.50, 26.00, 28.00, 30.00, 16.00}},
        {"C2", {0.125, 1.125, 0.375, 1.125, 0.625, 1.500, 0.625, 2.625, 2.750, 2.125, 2.000, 1.750,
                4.500, 4.750, 5.000, 4.000, 4.500, 7.500, 14.00, 11.50, 26.00, 28.00, 30.00, 16.00}},
        {"CO2", {0.000, 1.250, 1.625, 0.375, 0.375, 1.375, 1.125, 1.375, 0.125, 1.625, 3.750,
                3.500, 7.500, 8.000, 6.000, 16.00, 11.00, 24.00, 26.00, 28.00, 24.00, 26.00}},
        {"H2", {0.500, 0.625, 0.375, 0.625, 1.125, 2.625, 0.000, 0.250, 1.375, 4.000, 4.250, 5.000, 8.000, 8.000}},
        {"H2O", {0.500, 1.250, 1.875, 0.125, 1.500, 1.000, 0.750, 1.500, 0.625, 2.625, 5.000, 4.000, 4.500, 3.000, 4.000, 6.000}},
        {"He", {0.000, 0.125, 0.750, 1.000, 0.750, 2.625, 0.125, 1.250, 2.000, 1.000, 4.500, 5.000}},
        {"C3", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"nC4", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"iC4", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"nC5", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"iC5", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"nC6", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"nC7", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"nC8", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"nC9", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"nC10", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"O2", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"CO", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"H2S", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
        {"Ar", {0.250, 1.125, 1.500, 1.375, 0.250, 0.875, 0.625, 1.750, 3.625, 3.625, 14.500, 12.000}},
    };

    // Table A.6/A.7
    std::unordered_map<std::string, std::unordered_map<std::string, int>> K_pol_ij = {
        {"C1", {{"N2", 2}, {"CO2", 3}, {"C2", 2}, {"C3", 5}, {"nC4", 10}, {"iC4", 10}, {"H2", 4}}},
        {"N2", {{"CO2", 2}, {"C2", 3}}},
        {"C2", {{"C3", 10}, {"nC4", 10}, {"iC4", 10}}},
        {"C3", {{"nC4", 10}, {"iC4", 10}}},
        {"nC4", {{"iC4", 10}}}
    };
    std::unordered_map<std::string, std::unordered_map<std::string, int>> K_exp_ij = {
        {"C1", {{"N2", 7}, {"CO2", 3}, {"C2", 10}, {"C3", 4}, {"nC4", 0}, {"iC4", 0}, {"H2", 0}}},
        {"N2", {{"CO2", 4}, {"C2", 3}}},
        {"C2", {{"C3", 0}, {"nC4", 0}, {"iC4", 0}}},
        {"C3", {{"nC4", 0}, {"iC4", 0}}},
        {"nC4", {{"iC4", 0}}}
    };

    std::unordered_map<std::string, std::unordered_map<std::string, double>> F_ij = {
        {"C1", {{"N2", 1.}, {"CO2", 1.}, {"C2", 1.}, {"C3", 1.}, {"nC4", 1.}, {"iC4", 0.771035405688}, {"H2", 1.}}},
        {"N2", {{"CO2", 1.}, {"C2", 1.}}},
        {"C2", {{"C3", 0.130424765150}, {"nC4", 0.281570073085}, {"iC4", 0.260632376098}}},
        {"C3", {{"nC4", 0.312572600489e-1}, {"iC4", -0.551609771024e-1}}},
        {"nC4", {{"iC4", -0.551240293009e-1}}}
    };
    std::unordered_map<std::string, std::unordered_map<std::string, std::vector<int>>> d_ij = {
        {"C1", {
            {"N2", {1, 4, 1, 2, 2, 2, 2, 2, 3}},
            {"CO2", {1, 2, 3, 1, 2, 3}},
            {"C2", {3, 4, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3}},
            {"C3", {3, 3, 4, 4, 4, 1, 1, 1, 2}},
            {"H2", {1, 3, 3, 4}},
            {"nC4", {1, 1, 1, 2, 2, 3, 3, 4, 4, 4}},
            {"iC4", {1, 1, 1, 2, 2, 3, 3, 4, 4, 4}},
        }},
        {"N2", {
            {"CO2", {2, 3, 1, 1, 1, 2}},
            {"C2", {2, 2, 3, 1, 2, 2}},
        }},
        {"C2", {
            {"C3", {1, 1, 1, 2, 2, 3, 3, 4, 4, 4}},
            {"nC4", {1, 1, 1, 2, 2, 3, 3, 4, 4, 4}},
            {"iC4", {1, 1, 1, 2, 2, 3, 3, 4, 4, 4}},
        }},
        {"C3", {
            {"nC4", {1, 1, 1, 2, 2, 3, 3, 4, 4, 4}},
            {"iC4", {1, 1, 1, 2, 2, 3, 3, 4, 4, 4}},
        }},
        {"nC4", {
            {"iC4", {1, 1, 1, 2, 2, 3, 3, 4, 4, 4}},
        }}
    };
    std::unordered_map<std::string, std::unordered_map<std::string, std::vector<double>>> t_ij = {
        {"C1", {
            {"N2", {0.000, 1.850, 7.850, 5.400, 0.000, 0.750, 2.800, 4.450, 4.250}},
            {"CO2", {2.600, 1.950, 0.000, 3.950, 7.950, 8.000}},
            {"C2", {0.650, 1.550, 3.100, 5.900, 7.050, 3.350, 1.200, 5.800, 2.700, 0.450, 0.550, 1.950}},
            {"C3", {1.850, 3.950, 0.000, 1.850, 3.850, 5.250, 3.850, 0.200, 6.500}},
            {"H2", {2.000, -1.000, 1.750, 1.400}},
            {"nC4", {1.000, 1.550, 1.700, 0.250, 1.350, 0.000, 1.250, 0.000, 0.700, 5.400}},
            {"iC4", {1.000, 1.550, 1.700, 0.250, 1.350, 0.000, 1.250, 0.000, 0.700, 5.400}},
        }},
        {"N2", {
            {"CO2", {1.850, 1.400, 3.200, 2.500, 8.000, 3.750}},
            {"C2", {0.000, 0.050, 0.000, 3.650, 4.900, 4.450}},
        }},
        {"C2", {
            {"C3", {1.000, 1.550, 1.700, 0.250, 1.350, 0.000, 1.250, 0.000, 0.700, 5.400}},
            {"nC4", {1.000, 1.550, 1.700, 0.250, 1.350, 0.000, 1.250, 0.000, 0.700, 5.400}},
            {"iC4", {1.000, 1.550, 1.700, 0.250, 1.350, 0.000, 1.250, 0.000, 0.700, 5.400}},
        }},
        {"C3", {
            {"nC4", {1.000, 1.550, 1.700, 0.250, 1.350, 0.000, 1.250, 0.000, 0.700, 5.400}},
            {"iC4", {1.000, 1.550, 1.700, 0.250, 1.350, 0.000, 1.250, 0.000, 0.700, 5.400}},
        }},
        {"nC4", {
            {"iC4", {1.000, 1.550, 1.700, 0.250, 1.350, 0.000, 1.250, 0.000, 0.700, 5.400}},
        }}
    };
    std::unordered_map<std::string, std::unordered_map<std::string, std::vector<double>>> n_ij = {
        {"C1", {
            {"N2", {-0.98038985517335e-2, 0.42487270143005e-3, -0.34800214576142e-1, -0.13333813013896, -0.11993694974627e-1, 
                    0.69243379775168e-1, -0.31022508148249, 0.24495491753226, 0.22369816716981}},
            {"CO2", {-0.10859387354942, 0.80228576727389e-1, -0.93303985115717e-2, 0.40989274005848e-1, -0.24338019772494, 0.23855347281124}},
            {"C2", {-0.80926050298746e-3, -0.75381925080059e-3, -0.41618768891219e-1, -0.23452173681569, 0.14003840584586, 0.63281744807738e-1, 
                    -0.34660425848809e-1, -0.23918747334251, 0.19855255066891e-2, 0.61777746171555e1, -0.69575358271105e1, 0.10630185306388e1}},
            {"C3", {0.13746429958576e-1, -0.74425012129552e-2, -0.45516600213685e-2, -0.54546603350237e-2, 0.23682016824471e-2, 
                    0.18007763721438, -0.44773942932486, 0.19327374888200e-1, -0.30632197804624}},
            {"H2", {-0.25157134971934, -0.62203841111983e-2, 0.88850315184396e-1, -0.35592212573239e-1}},
            {"nC4", {0.25574776844118e1, -0.79846357136353e1, 0.47859131465806e1, -0.73265392369587, 0.13805471345312e1, 
                    0.28349603476365, -0.49087385940425, -0.10291888921447, 0.11836314681968, 0.55527385721943e-4}},
            {"iC4", {0.25574776844118e1, -0.79846357136353e1, 0.47859131465806e1, -0.73265392369587, 0.13805471345312e1, 
                    0.28349603476365, -0.49087385940425, -0.10291888921447, 0.11836314681968, 0.55527385721943e-4}},
        }},
        {"N2", {
            {"CO2", {0.28661625028399, -0.10919833861247, -0.11374032082270e1, 0.76580544237358, 0.42638000926819e-2, 0.17673538204534}},
            {"C2", {-0.47376518126608, 0.48961193461001, -0.57011062090535e-2, -0.19966820041320, -0.69411103101723, 0.69226192739021}},
        }},
        {"C2", {
            {"C3", {0.25574776844118e1, -0.79846357136353e1, 0.47859131465806e1, -0.73265392369587, 0.13805471345312e1, 
                    0.28349603476365, -0.49087385940425, -0.10291888921447, 0.11836314681968, 0.55527385721943e-4}},
            {"nC4", {0.25574776844118e1, -0.79846357136353e1, 0.47859131465806e1, -0.73265392369587, 0.13805471345312e1, 
                    0.28349603476365, -0.49087385940425, -0.10291888921447, 0.11836314681968, 0.55527385721943e-4}},
            {"iC4", {0.25574776844118e1, -0.79846357136353e1, 0.47859131465806e1, -0.73265392369587, 0.13805471345312e1, 
                    0.28349603476365, -0.49087385940425, -0.10291888921447, 0.11836314681968, 0.55527385721943e-4}},
        }},
        {"C3", {
            {"nC4", {0.25574776844118e1, -0.79846357136353e1, 0.47859131465806e1, -0.73265392369587, 0.13805471345312e1, 
                    0.28349603476365, -0.49087385940425, -0.10291888921447, 0.11836314681968, 0.55527385721943e-4}},
            {"iC4", {0.25574776844118e1, -0.79846357136353e1, 0.47859131465806e1, -0.73265392369587, 0.13805471345312e1, 
                    0.28349603476365, -0.49087385940425, -0.10291888921447, 0.11836314681968, 0.55527385721943e-4}},
        }},
        {"nC4", {
            {"iC4", {0.25574776844118e1, -0.79846357136353e1, 0.47859131465806e1, -0.73265392369587, 0.13805471345312e1, 
                    0.28349603476365, -0.49087385940425, -0.10291888921447, 0.11836314681968, 0.55527385721943e-4}},
        }}
    };
    std::unordered_map<std::string, std::unordered_map<std::string, std::vector<double>>> eta_ij = {
        {"C1", {
            {"N2", {0., 0., 1.000, 1.000, 0.250, 0.000, 0.000, 0.000, 0.000}},
            {"CO2", {0., 0., 0., 1.000, 0.500, 0.000}},
            {"C2", {0., 0., 1.000, 1.000, 1.000, 0.875, 0.750, 0.500, 0.000, 0.000, 0.000, 0.000}},
            {"C3", {0., 0., 0., 0., 0., 0.250, 0.250, 0.000, 0.000}},
            {"H2", std::vector<double>(4, 0.)},
            {"nC4", std::vector<double>(10, 0.)},
            {"iC4", std::vector<double>(10, 0.)},
        }},
        {"N2", {
            {"CO2", {0., 0., 0.250, 0.250, 0.000, 0.000}},
            {"C2", {0., 0., 0., 1.000, 1.000, 0.875}},
        }},
        {"C2", {
            {"C3", std::vector<double>(10, 0.)},
            {"nC4", std::vector<double>(10, 0.)},
            {"iC4", std::vector<double>(10, 0.)},
        }},
        {"C3", {
            {"nC4", std::vector<double>(10, 0.)},
            {"iC4", std::vector<double>(10, 0.)},
        }},
        {"nC4", {
            {"iC4", std::vector<double>(10, 0.)},
        }}
    };
    std::unordered_map<std::string, std::unordered_map<std::string, std::vector<double>>> eps_ij = {
        {"C1", {
            {"N2", {0., 0., 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5}},
            {"CO2", {0., 0., 0., 0.5, 0.5, 0.5}},
            {"C2", {0., 0., 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5}},
            {"C3", {0., 0., 0., 0., 0., 0.5, 0.5, 0.5, 0.5}},
            {"H2", std::vector<double>(4, 0.)},
            {"nC4", std::vector<double>(10, 0.)},
            {"iC4", std::vector<double>(10, 0.)},
        }},
        {"N2", {
            {"CO2", {0., 0., 0.5, 0.5, 0.5, 0.5}},
            {"C2", {0., 0., 0., 0.5, 0.5, 0.5}},
        }},
        {"C2", {
            {"C3", std::vector<double>(10, 0.)},
            {"nC4", std::vector<double>(10, 0.)},
            {"iC4", std::vector<double>(10, 0.)},
        }},
        {"C3", {
            {"nC4", std::vector<double>(10, 0.)},
            {"iC4", std::vector<double>(10, 0.)},
        }},
        {"nC4", {
            {"iC4", std::vector<double>(10, 0.)},
        }}
    };
    std::unordered_map<std::string, std::unordered_map<std::string, std::vector<double>>> beta_ij = {
        {"C1", {
            {"N2", {0., 0., 1.000, 1.000, 2.500, 3.000, 3.000, 3.000, 3.000}},
            {"CO2", {0., 0., 0., 1.000, 2.000, 3.000}},
            {"C2", {0., 0., 1.000, 1.000, 1.000, 1.250, 1.500, 2.000, 3.000, 3.000, 3.000, 3.000}},
            {"C3", {0., 0., 0., 0., 0., 0.750, 1.000, 2.000, 3.000}},
            {"H2", std::vector<double>(4, 0.)},
            {"nC4", std::vector<double>(10, 0.)},
            {"iC4", std::vector<double>(10, 0.)},
        }},
        {"N2", {
            {"CO2", {0., 0., 0.750, 1.000, 2.000, 3.000}},
            {"C2", {0., 0., 0., 1.000, 1.000, 1.250}},
        }},
        {"C2", {
            {"C3", std::vector<double>(10, 0.)},
            {"nC4", std::vector<double>(10, 0.)},
            {"iC4", std::vector<double>(10, 0.)},
        }},
        {"C3", {
            {"nC4", std::vector<double>(10, 0.)},
            {"iC4", std::vector<double>(10, 0.)},
        }},
        {"nC4", {
            {"iC4", std::vector<double>(10, 0.)},
        }}
    };
    std::unordered_map<std::string, std::unordered_map<std::string, std::vector<double>>> j_ij = {
        {"C1", {
            {"N2", {0., 0., 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5}},
            {"CO2", {0., 0., 0., 0.5, 0.5, 0.5}},
            {"C2", {0., 0., 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5}},
            {"C3", {0., 0., 0., 0., 0., 0.5, 0.5, 0.5, 0.5}},
            {"H2", std::vector<double>(4, 0.)},
            {"nC4", std::vector<double>(10, 0.)},
            {"iC4", std::vector<double>(10, 0.)},
        }},
        {"N2", {
            {"CO2", {0., 0., 0.5, 0.5, 0.5, 0.5}},
            {"C2", {0., 0., 0., 0.5, 0.5, 0.5}},
        }},
        {"C2", {
            {"C3", std::vector<double>(10, 0.)},
            {"nC4", std::vector<double>(10, 0.)},
            {"iC4", std::vector<double>(10, 0.)},
        }},
        {"C3", {
            {"nC4", std::vector<double>(10, 0.)},
            {"iC4", std::vector<double>(10, 0.)},
        }},
        {"nC4", {
            {"iC4", std::vector<double>(10, 0.)},
        }}
    };

    // Table A.8
    std::unordered_map<std::string, std::unordered_map<std::string, double>> beta_vij = {
        {"C1", {
            {"N2", 0.998721377}, {"CO2", 0.999518072}, {"C2", 0.997547866}, {"C3", 1.004827070}, {"nC4", 0.979105972}, {"iC4", 1.011240388}, 
            {"nC5", 0.948330120}, {"iC5", 1.0}, {"nC6", 0.958015294}, {"nC7", 0.962050831}, {"nC8", 0.994740603}, {"nC9", 1.002852287}, {"nC10", 1.033086292}, 
            {"H2", 1.0}, {"O2", 1.0}, {"CO", 0.997340772}, {"H2O", 1.012783169}, {"H2S", 1.012599087}, {"He", 1.0}, {"Ar", 1.034630259}, 
        }},
        {"N2", {
            {"CO2", 0.977794634}, {"C2", 0.978880168}, {"C3", 0.974424681}, {"nC4", 0.996082610}, {"iC4", 0.986415830}, 
            {"nC5", 1.0}, {"iC5", 1.0}, {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 1.0}, 
            {"H2", 0.972532065}, {"O2", 0.999521770}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.910394249}, {"He", 0.969501055}, {"Ar", 1.004166412}, 
        }},
        {"CO2", {
            {"C2", 1.002525718}, {"C3", 0.996898004}, {"nC4", 1.174760923}, {"iC4", 1.076551882}, 
            {"nC5", 1.024311498}, {"iC5", 1.060793104}, {"nC6", 1.0}, {"nC7", 1.205469976}, {"nC8", 1.026169373}, {"nC9", 1.0}, {"nC10", 1.000151132}, 
            {"H2", 0.904142159}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 0.949055959}, {"H2S", 0.906630564}, {"He", 0.846647561}, {"Ar", 1.008392428}, 
        }},
        {"C2", {
            {"C3", 0.997607277}, {"nC4", 0.999157205}, {"iC4", 1.0}, {"nC5", 0.993851009}, {"iC5", 1.0}, 
            {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.007469726}, {"nC9", 1.0}, {"nC10", 0.995676258}, 
            {"H2", 0.925367171}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.010817909}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"C3", {
            {"nC4", 0.999795868}, {"iC4", 0.999243146}, {"nC5", 1.044919431}, {"iC5", 1.040459289}, {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 0.984104227}, 
            {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.936811219}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC4", {
            {"iC4", 1.000880464}, {"nC5", 1.0}, {"iC5", 1.0}, {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 0.976951968}, 
            {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.908113163}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"iC4", {
            {"nC5", 1.0}, {"iC5", 1.0}, {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 1.0},
            {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.012994431}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC5", {
            {"iC5", 1.0}, {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 1.0},
            {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.984613203}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"iC5", {
            {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 1.0},
            {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC6", {
            {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 1.001516371}, 
            {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.754473958}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC7", {
            {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 1.0}, {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.828967164}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC8", {
            {"nC9", 1.0}, {"nC10", 1.0}, {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC9", {
            {"nC10", 1.0}, {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC10", {
            {"H2", 1.695358382}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"H2", {
            {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"O2", {
            {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 0.999746847}, 
        }},
        {"CO", {
            {"H2O", 1.0}, {"H2S", 0.795660392}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"H2O", {
            {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"H2S", {
            {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"He", {
            {"Ar", 1.0}, 
        }},
    };
    std::unordered_map<std::string, std::unordered_map<std::string, double>> j_vij = {
        {"C1", {
            {"N2", 1.013950311}, {"CO2", 1.002806594}, {"C2", 1.006617867}, {"C3", 1.038470657}, {"nC4", 1.045375122}, {"iC4", 1.054319053}, 
            {"nC5", 1.124508039}, {"iC5", 1.343685343}, {"nC6", 1.052643846}, {"nC7", 1.156655935}, {"nC8", 1.116549372}, {"nC9", 1.141895355}, {"nC10", 1.146089637}, 
            {"H2", 1.018702573}, {"O2", 1.0}, {"CO", 1.006102927}, {"H2O", 1.585018334}, {"H2S", 1.040161207}, {"He", 0.881405683}, {"Ar", 1.014678542}, 
        }},
        {"N2", {
            {"CO2", 1.047578256}, {"C2", 1.042352891}, {"C3", 1.081025408}, {"nC4", 1.146949309}, {"iC4", 1.100576129}, 
            {"nC5", 1.078877166}, {"iC5", 1.154135439}, {"nC6", 1.195952177}, {"nC7", 1.404554090}, {"nC8", 1.186067025}, {"nC9", 1.100405929}, {"nC10", 1.0}, 
            {"H2", 0.970115357}, {"O2", 0.997082328}, {"CO", 1.008690943}, {"H2O", 1.094749685}, {"H2S", 1.256844157}, {"He", 0.932629867}, {"Ar", 1.002212182}, 
        }},
        {"CO2", {
            {"C2", 1.032876701}, {"C3", 1.047596298}, {"nC4", 1.222437324}, {"iC4", 1.081909003}, {"nC5", 1.068406078}, {"iC5", 1.116793198}, 
            {"nC6", 0.851343711}, {"nC7", 1.164585914}, {"nC8", 1.104043935}, {"nC9", 0.973386152}, {"nC10", 1.183394668}, 
            {"H2", 1.152792550}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.542328793}, {"H2S", 1.024085837}, {"He", 0.864141549}, {"Ar", 1.029205465}, 
        }},
        {"C2", {
            {"C3", 1.003034720}, {"nC4", 1.006179146}, {"iC4", 1.006616886}, {"nC5", 1.026085655}, {"iC5", 1.045439935}, 
            {"nC6", 1.169701102}, {"nC7", 1.057666085}, {"nC8", 1.071917985}, {"nC9", 1.143534730}, {"nC10", 1.098361281}, 
            {"H2", 1.106072040}, {"O2", 1.0}, {"CO", 1.201417898}, {"H2O", 1.0}, {"H2S", 1.030988277}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"C3", {
            {"nC4", 1.003264179}, {"iC4", 1.001156119}, {"nC5", 1.019921513}, {"iC5", 0.999432118}, 
            {"nC6", 1.057872566}, {"nC7", 1.079648053}, {"nC8", 1.102764612}, {"nC9", 1.199769134}, {"nC10", 1.053040574}, 
            {"H2", 1.074006110}, {"O2", 1.0}, {"CO", 1.108143673}, {"H2O", 1.011759763}, {"H2S", 1.010593999}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC4", {
            {"iC4", 1.000414440}, {"nC5", 1.018159650}, {"iC5", 1.002728434}, 
            {"nC6", 1.034995284}, {"nC7", 1.019174227}, {"nC8", 1.046905515}, {"nC9", 1.049219137}, {"nC10", 1.027845529}, 
            {"H2", 1.232939523}, {"O2", 1.0}, {"CO", 1.084740904}, {"H2O", 1.223638763}, {"H2S", 1.033366041}, {"He", 1.0}, {"Ar", 1.214638734}, 
        }},
        {"iC4", {
            {"nC5", 1.002779804}, {"iC5", 1.002284353}, {"nC6", 1.010493989}, {"nC7", 1.021668316}, {"nC8", 1.032807063}, {"nC9", 1.047298475}, {"nC10", 1.060243344}, 
            {"H2", 1.147595688}, {"O2", 1.0}, {"CO", 1.087272232}, {"H2O", 1.0}, {"H2S", 0.988591117}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC5", {
            {"iC5", 1.000024335}, {"nC6", 1.002480637}, {"nC7", 1.008972412}, {"nC8", 1.069223964}, {"nC9", 1.034910633}, {"nC10", 1.016370338}, 
            {"H2", 1.188334783}, {"O2", 1.0}, {"CO", 1.119954454}, {"H2O", 0.956677310}, {"H2S", 1.076539234}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"iC5", {
            {"nC6", 1.002995876}, {"nC7", 1.009928206}, {"nC8", 1.017880545}, {"nC9", 1.028994325}, {"nC10", 1.039372957}, 
            {"H2", 1.184340443}, {"O2", 1.0}, {"CO", 1.116694577}, {"H2O", 1.0}, {"H2S", 0.835763343}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC6", {
            {"nC7", 1.001508227}, {"nC8", 1.006268954}, {"nC9", 1.020761680}, {"nC10", 1.013511439}, 
            {"H2", 1.243461678}, {"O2", 1.0}, {"CO", 1.155145836}, {"H2O", 1.170217596}, {"H2S", 1.339283552}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC7", {
            {"nC8", 1.006767176}, {"nC9", 1.001370076}, {"nC10", 1.002972346}, 
            {"H2", 1.159131722}, {"O2", 1.0}, {"CO", 1.190354273}, {"H2O", 1.0}, {"H2S", 1.087956749}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC8", {
            {"nC9", 1.001357085}, {"nC10", 1.002553544}, {"H2", 1.305249405}, {"O2", 1.0}, {"CO", 1.219206702}, {"H2O", 0.599484191}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC9", {
            {"nC10", 1.000810520}, {"H2", 1.342647661}, {"O2", 1.0}, {"CO", 1.252151449}, {"H2O", 1.0}, {"H2S", 1.082905109}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC10", {
            {"H2", 1.120233729}, {"O2", 1.0}, {"CO", 0.870184960}, {"H2O", 0.551405318}, {"H2S", 1.171714677}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"H2", {
            {"O2", 1.0}, {"CO", 1.121416201}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"O2", {
            {"CO", 1.0}, {"H2O", 1.143174289}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 0.993907223}, 
        }},
        {"CO", {
            {"H2O", 1.0}, {"H2S", 1.101731308}, {"He", 1.0}, {"Ar", 1.159720623}, 
        }},
        {"H2O", {
            {"H2S", 1.014832832}, {"He", 1.0}, {"Ar", 1.038993495}, 
        }},
        {"H2S", {
            {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"He", {
            {"Ar", 1.0}, 
        }},
    };
    std::unordered_map<std::string, std::unordered_map<std::string, double>> beta_Tij = {
        {"C1", {
            {"N2", 0.998098830}, {"CO2", 1.022624490}, {"C2", 0.996336508}, {"C3", 0.989680305}, {"nC4", 0.994174910}, {"iC4", 0.980315756}, 
            {"nC5", 0.992127525}, {"iC5", 1.0}, {"nC6", 0.981844797}, {"nC7", 0.977431529}, {"nC8", 0.957473785}, {"nC9", 0.947716769}, {"nC10", 0.937777823}, 
            {"H2", 1.0}, {"O2", 1.0}, {"CO", 0.987411732}, {"H2O", 1.063333913}, {"H2S", 1.011090031}, {"He", 1.0}, {"Ar", 0.990954281}, 
        }},
        {"N2", {
            {"CO2", 1.005894529}, {"C2", 1.007671428}, {"C3", 1.002677329}, {"nC4", 0.994515234}, {"iC4", 0.992868130}, 
            {"nC5", 1.0}, {"iC5", 1.0}, {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 0.956379450}, {"nC10", 0.957934447}, 
            {"H2", 0.946134337}, {"O2", 0.997190589}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.004692366}, {"He", 0.692868765}, {"Ar", 0.999069843}, 
        }},
        {"CO2", {
            {"C2", 1.013871147}, {"C3", 1.033620538}, {"nC4", 1.018171004}, {"iC4", 1.023339824}, {"nC5", 1.027000795}, {"iC5", 1.019180957}, 
            {"nC6", 1.0}, {"nC7", 1.011806317}, {"nC8", 1.029690780}, {"nC9", 1.007688620}, {"nC10", 1.020028790}, 
            {"H2", 0.942320195}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 0.997372205}, {"H2S", 1.016034583}, {"He", 0.768377630}, {"Ar", 0.996512863}, 
        }},
        {"C2", {
            {"C3", 0.996199694}, {"nC4", 0.999130554}, {"iC4", 1.0}, {"nC5", 0.998688946}, {"iC5", 1.0}, 
            {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 0.984068272}, {"nC9", 1.0}, {"nC10", 0.970918061}, 
            {"H2", 0.932969831}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.990197354}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"C3", {
            {"nC4", 1.000310289}, {"iC4", 0.998012298}, {"nC5", 0.996484021}, {"iC5", 0.994364425}, {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 0.985331233}, 
            {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.992573556}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC4", {
            {"iC4", 1.000077547}, {"nC5", 1.0}, {"iC5", 1.0}, {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 0.993688386}, 
            {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.985962886}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"iC4", {
            {"nC5", 1.0}, {"iC5", 1.0}, {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 1.0}, 
            {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.974550548}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC5", {
            {"iC5", 1.0}, {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 1.0}, 
            {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.962006651}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"iC5", {
            {"nC6", 1.0}, {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 1.0}, {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC6", {
            {"nC7", 1.0}, {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 0.997641010}, {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.985891113}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC7", {
            {"nC8", 1.0}, {"nC9", 1.0}, {"nC10", 1.0}, {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 0.988937417}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC8", {
            {"nC9", 1.0}, {"nC10", 1.0}, {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC9", {
            {"nC10", 1.0}, {"H2", 1.0}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC10", {
            {"H2", 1.064818089}, {"O2", 1.0}, {"CO", 1.049594632}, {"H2O", 0.897162268}, {"H2S", 0.973091413}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"H2", {
            {"O2", 1.0}, {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"O2", {
            {"CO", 1.0}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.000023103}, 
        }},
        {"CO", {
            {"H2O", 1.0}, {"H2S", 1.025536736}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"H2O", {
            {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"H2S", {
            {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"He", {
            {"Ar", 1.0}, 
        }},
    };
    std::unordered_map<std::string, std::unordered_map<std::string, double>> j_Tij = {
        {"C1", {
            {"N2", 0.979273013}, {"CO2", 0.975665369}, {"C2", 1.049707697}, {"C3", 1.098655531}, {"nC4", 1.171607691}, {"iC4", 1.161117729}, 
            {"nC5", 1.249173968}, {"iC5", 1.188899743}, {"nC6", 1.330570181}, {"nC7", 1.379850328}, {"nC8", 1.449245409}, {"nC9", 1.528532478}, {"nC10", 1.568231489}, 
            {"H2", 1.352643115}, {"O2", 0.950000000}, {"CO", 0.987473033}, {"H2O", 0.775810513}, {"H2S", 0.961155729}, {"He", 3.159776855}, {"Ar", 0.989843388}, 
        }},
        {"N2", {
            {"CO2", 1.107654104}, {"C2", 1.098650964}, {"C3", 1.201264026}, {"nC4", 1.304886838}, {"iC4", 1.284462634}, 
            {"nC5", 1.419029041}, {"iC5", 1.381770770}, {"nC6", 1.472607971}, {"nC7", 1.520975334}, {"nC8", 1.733280051}, {"nC9", 1.749119996}, {"nC10", 1.822157123}, 
            {"H2", 1.175696583}, {"O2", 0.995157044}, {"CO", 0.993425388}, {"H2O", 0.968808467}, {"H2S", 0.960174200}, {"He", 1.471831580}, {"Ar", 0.990034831}, 
        }},
        {"CO2", {
            {"C2", 0.900949530}, {"C3", 0.908772477}, {"nC4", 0.911498231}, {"iC4", 0.929982936}, {"nC5", 0.979217302}, {"iC5", 0.961218039}, 
            {"nC6", 1.038675574}, {"nC7", 1.046169823}, {"nC8", 1.074455386}, {"nC9", 1.140671202}, {"nC10", 1.145512213}, 
            {"H2", 1.782924792}, {"O2", 1.0}, {"CO", 1.0}, {"H2O", 0.775453996}, {"H2S", 0.926018880}, {"He", 3.207456948}, {"Ar", 1.050971635}, 
        }},
        {"C2", {
            {"C3", 1.014730190}, {"nC4", 1.034832749}, {"iC4", 1.033283811}, {"nC5", 1.066665676}, {"iC5", 1.021150247}, 
            {"nC6", 1.092177796}, {"nC7", 1.134532014}, {"nC8", 1.168636194}, {"nC9", 1.056033030}, {"nC10", 1.237191558}, 
            {"H2", 1.902008495}, {"O2", 1.0}, {"CO", 1.069224728}, {"H2O", 1.0}, {"H2S", 0.902736660}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"C3", {
            {"nC4", 1.007392782}, {"iC4", 1.005250774}, {"nC5", 1.008344412}, {"iC5", 1.003269500}, 
            {"nC6", 1.025657518}, {"nC7", 1.050044169}, {"nC8", 1.063694129}, {"nC9", 1.109973833}, {"nC10", 1.140905252}, 
            {"H2", 2.308215191}, {"O2", 1.0}, {"CO", 1.197564208}, {"H2O", 0.600340961}, {"H2S", 0.905829247}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC4", {
            {"iC4", 1.001432824}, {"nC5", 1.002143640}, {"iC5", 1.000792201}, {"nC6", 1.009157060}, 
            {"nC7", 1.021283378}, {"nC8", 1.033180106}, {"nC9", 1.014096448}, {"nC10", 1.076466918}, 
            {"H2", 2.509259945}, {"O2", 1.0}, {"CO", 1.173916162}, {"H2O", 0.615512682}, {"H2S", 0.926156602}, {"He", 1.0}, {"Ar", 1.245039498}, 
        }},
        {"iC4", {
            {"nC5", 1.002495889}, {"iC5", 1.001835788}, {"nC6", 1.006018054}, {"nC7", 1.009885760}, {"nC8", 1.013945424}, {"nC9", 1.017817492}, {"nC10", 1.021624748}, 
            {"H2", 1.895305393}, {"O2", 1.0}, {"CO", 1.161390082}, {"H2O", 1.0}, {"H2S", 0.937130844}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC5", {
            {"iC5", 1.000050537}, {"nC6", 1.000761237}, {"nC7", 1.002441051}, {"nC8", 1.016422347}, {"nC9", 1.103421755}, {"nC10", 1.049035838}, 
            {"H2", 2.013859174}, {"O2", 1.0}, {"CO", 1.206043295}, {"H2O", 0.447666011}, {"H2S", 0.959065662}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"iC5", {
            {"nC6", 1.001204174}, {"nC7", 1.003194615}, {"nC8", 1.005647480}, {"nC9", 1.008191499}, {"nC10", 1.010825138}, 
            {"H2", 1.996386669}, {"O2", 1.0}, {"CO", 1.199326059}, {"H2O", 1.0}, {"H2S", 0.982651529}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC6", {
            {"nC7", 0.999762786}, {"nC8", 1.001633952}, {"nC9", 1.055369591}, {"nC10", 1.028939539}, 
            {"H2", 3.021197546}, {"O2", 1.0}, {"CO", 1.233272781}, {"H2O", 0.569681333}, {"H2S", 0.956075596}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC7", {
            {"nC8", 0.998793111}, {"nC9", 1.001150096}, {"nC10", 1.002229938}, 
            {"H2", 3.169143057}, {"O2", 1.0}, {"CO", 1.256123503}, {"H2O", 1.0}, {"H2S", 1.013453092}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC8", {
            {"nC9", 1.000235044}, {"nC10", 1.007186267}, {"H2", 2.191555216}, {"O2", 1.0}, {"CO", 1.276565536}, {"H2O", 0.662072469}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC9", {
            {"nC10", 1.000182392}, {"H2", 2.234354040}, {"O2", 1.0}, {"CO", 1.294070556}, {"H2O", 1.0}, {"H2S", 1.086557826}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"nC10", {
            {"H2", 3.786003724}, {"O2", 1.0}, {"CO", 1.803567587}, {"H2O", 0.740416402}, {"H2S", 1.103693489}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"H2", {
            {"O2", 1.0}, {"CO", 1.377504607}, {"H2O", 1.0}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"O2", {
            {"CO", 1.0}, {"H2O", 0.964767932}, {"H2S", 1.0}, {"He", 1.0}, {"Ar", 0.990430423}, 
        }},
        {"CO", {
            {"H2O", 1.0}, {"H2S", 1.022749748}, {"He", 1.0}, {"Ar", 0.954215746}, 
        }},
        {"H2O", {
            {"H2S", 0.940587083}, {"He", 1.0}, {"Ar", 1.070941866}, 
        }},
        {"H2S", {
            {"He", 1.0}, {"Ar", 1.0}, 
        }},
        {"He", {
            {"Ar", 1.0}, 
        }},
    };
}

/*
void GERG::first_order(double T, double V, double N) {
    // A(rho, T, x) = A^0(rho, T, x) + A^r(rho, T, x)
    // a(delta, tau, x) = a^0(rho, T, x) + a^r(delta, tau, x)

    // a^0(rho, T, x) = sum_i(x[i] [a^0_oi(rho, T) + lnx[i]])

    // a^r(delta, tau, x) = sum_i(x[i] a^r_oi(delta, tau) + sum_i(sum_j(x[i]x[j]F_ij a^r_ij(delta, tau))))

    // delta = rho/rho_r(x)
    // tau = T_r(x)/T

    // a^0_oi(rho, T) = ln(rho/rho_ci) + R*_/R * [n^o_oi,1 + n^o_oi,2 * T_ci/T + n^o_oi,3*ln(T_ci/T)
    //                  + sum_k(n^o_oi,k * ln(|sinh(theta^o_oi,k * T_ci/T)|))
    //                  - sum_k(n^o_oi,k * ln(|sinh(theta^o_oi,k * T_ci/T)|))]

    double R = 8.314472;  // J/mol.K
    double R_ = 8.314510;
    double R_R = R_/R;

    // a^r_oi(delta, tau) = sum_k(n_oi,k * delta^d_oi,k * tau^t_oi,k) + sum_k(n_oi,k * delta^d_oi,k * tau^t_oi,k * exp^-delta^c_oi,k)

    // a^r_ij(delta, tau) = sum_k(n_ij,k * delta^d_ij,k * tau^t_ij,k) + 
    //                      sum_k(n_ij,k * delta^d_ij,k * tau^t_ij,k * exp[-eta_ij,k*(delta-eps_ij,k)^2 - beta_ij,k*(delta-j_ij,k)])
    
    // 1/rho_r(x) = sum_i(x[i]^2 * 1/rho_ci) + sum_i(sum_j(2*x[i]x[j]*beta_v,ij*j_v,ij * (x[i]+x[j])/(beta_v,ij^2*x[i] + x[j]) * 
    //              1/8 * (1/rho_ci^(1/3) + 1/rho_cj^(1/3))^3))
    // T_r(x) = sum_i(x[i]^2 * T_ci) + sum_i(sum_j(2*x[i]x[j]*beta_T,ij*j_T,ij * (x[i]+x[j])/(beta_T,ij^2*x[i] + x[j]) * 
    //          (T_ci*T_cj)^(1/2))
    return;
}

void GERG::second_order(double T, double V, double N) {
    return;
}

double GERG::dP_dT() {
    return rho * R * (1 + delta * ar_d() - delta * tau * ar_dt());
}
double GERG::dP_drho() {
    return R * T * (1 + 2 * delta * ar_d() + pow(delta, 2) * ar_dd());
}
double GERG::ndP_dV() {
    return -std::pow(rho, 2) * this->dP_drho();
}
double GERG::dP_dV() {
    return this->ndP_dV() / N;
}
double GERG::ndP_dni(int i) {
    return rho * R * T * (1 + delta * this->ar_d() * (2 - 1/rho_r * this->ndrhor_dni(i)) + delta * this->ndard_dni(i));
}
double GERG::dP_dni(int i) {
    return this->ndP_dni(i) / N;
}

// Table B4
double GERG::dna0_dni(int i) {
    return this->ao_oi(i) + 1 + std::log(x[i]);
}
double GERG::dnar_dni(int i) {
    return this->ar() + this->ndar_dni(i);
}
double GERG::ndar_dni(int i) {
    double sum_xk_ark = 0;
    return delta * this->ar_d() * (1 - 1/rho_r * this->ndrhor_dni(i)) + tau * this->ar_t() * 1/T_r * this->ndTr_dni(i) + this->ar_x(i) - sum_xk_ark;
}
double GERG::ndard_dni(int i) {
    double sum_xk_ardk = 0;
    return delta * this->ar_dd() * (1 - 1/rho_r * this->ndrhor_dni(i)) + tau * this->ar_dt() * 1/T_r * this->ndTr_dni(i) + this->ar_dx(i) - sum_xk_ardk;
}
double GERG::ndrhor_dni(int i) {
    double rhor_x = -std::pow(rho_r, 2) * this->Y_x('v', i);
    double sum_xk_rhork = 0;
    return rhor_x - sum_xk_rhork;
}
double GERG::ndTr_dni(int i) {
    double sum_xk_Trk = 0;
    return this->Y_x('T', i) - sum_xk_Trk;
}

// Table B5
double GERG::ao() {
    double a0 = x[i] * (this->ao_oi(i) + std::log(x[i]));
    return a0;
}
double GERG::ao_d() {
    double a0_d = x[i] * rho_r/rho_ci * this->dao_oi_drhoci(i);
    return a0_d;
}
double GERG::ao_dd() {
    double a0_dd = x[i] * std::pow(rho_r/rho_ci, 2) * this->d2ao_oi_drhoci2(i);
    return a0_dd;
}
double GERG::ao_dt() {
    double a0_dt = x[i] * rho_r/rho_ci * T_ci/T_r * this->d2ao_oi_drhoci_dTci(i);
    return a0_dt;
}
double GERG::ao_t() {
    double a0_t = x[i] * T_ci/T_r * this->dao_oi_dTci(i);
    return a0_t;
}
double GERG::ao_tt() {
    double a0_tt = x[i] * std::pow(T_ci/T_r, 2) * d2ao_oi_dTci2(i);
    return a0_tt;
}

double GERG::ar() {
    double sum_xi_aroi = x[i] * this->ar_oi(i);
    double sum_xixj_Fa = x[i] * x[j] * F_ij[i, j] * this->ar_ij(i, j);
    return sum_xi_aroi + sum_xixj_Fa;
}
double GERG::ar_d() {
    double sum_xi_dard = x[i] * this->dar_oi_dd(i);
    double sum_xixj_Fdad = x[i] * x[j] * F_ij[i, j] * this->dar_ij_dd(i, j);
    return sum_xi_dard + sum_xixj_Fdad;
}
double GERG::ar_dd() {
    double sum_xi_d2ard2 = x[i] * this->d2ar_oi_dd2(i);
    double sum_xixj_Fd2ad2 = x[i] * x[j] * F_ij[i, j] * this->d2ar_ij_dd2(i, j);
    return sum_xi_d2ard2 + sum_xixj_Fd2ad2;
}
double GERG::ar_dt() {
    double sum_xi_d2ardt = x[i] * this->d2ar_oi_ddt(i);
    double sum_xixj_Fd2adt = x[i] * x[j] * F_ij[i, j] * this->d2ar_ij_ddt(i, j);
    return sum_xi_d2ardt + sum_xixj_Fd2adt;
}
double GERG::ar_t() {
    double sum_xi_dart = x[i] * this->dar_oi_dt(i);
    double sum_xixj_Fdat = x[i] * x[j] * F_ij[i, j] * this->dar_ij_dt(i, j);
    return sum_xi_dart + sum_xixj_Fdat;
}
double GERG::ar_tt() {
    double sum_xi_d2art2 = x[i] * this->d2ar_oi_dt2(i);
    double sum_xixj_Fd2at2 = x[i] * x[j] * F_ij[i, j] * this->d2ar_ij_dt2(i, j);
    return sum_xi_d2art2 + sum_xixj_Fd2at2;
}
double GERG::ar_x(int i) {
    double sum_xk_Fa = x[k] * F_ij[i, k] * this->ar_ij(i, k);
    return this->ar_oi(i) + sum_xk_Fa;
}
double GERG::ar_xx(int i, int j) {
    if (i == j)
    {
        return 0.;
    }
    else
    {
        return F_ij[i, j] * this->ar_ij(i, j);
    }
}
double GERG::ar_dx(int i) {
    double sum_xk_Fdard = x[k] * F_ij[i, k] * this->dar_ij_dd(i, k);
    return this->dar_oi_dd(i) + sum_xk_Fdard;
}
double GERG::ar_tx(int i) {
    double sum_xk_Fdart = x[k] * F_ij[i, k] * this->dar_ij_dt(i, k);
    return this->dar_oi_dt(i) + sum_xk_Fdart;
}

// Table B6
double GERG::ao_oi(int i) {
    double sum_sinh = no_oi[k, i] * std::log(std::fabs(std::sinh(thetao_oi[k, i] * T_ci/T)));
    double sum_cosh = no_oi[k, i] * std::log(std::cosh(thetao_oi[k, i] * T_ci/T));
    return std::log(rho/rho_ci) + R_R * (no_oi[0, i] + no_oi[1, i] * T_ci/T + no_oi[2, i] * std::log(T_ci/T) + sum_sinh - sum_cosh);
}
double GERG::dao_oi_drhoci(int i) {
    return rho_ci/rho;
}
double GERG::d2ao_oi_drhoci2(int i) {
    return -std::pow(rho_ci/rho, 2);
}
double GERG::d2ao_oi_drhoci_dTci(int i) { 
    return 0.; 
}
double GERG::dao_oi_dTci(int i) {
    double sum_nt_tanh = no_oi[k, i] * thetao_oi[k, i] / std::tanh(thetao_oi[k, i] * T_ci/T);
    double sum_nttanh = no_oi[k, i] * thetao_oi[k, i] * std::tanh(thetao_oi[k, i] * T_ci/T);
    return R_R * (no_oi[1, i] + no_oi[2, i] * T/T_ci + sum_nt_tanh - sum_nttanh);
}
double GERG::d2ao_oi_dTci2(int i) {
    double sum_sinh = no_oi[k, i] * std::pow(thetao_oi[k, i], 2) / std::pow(std::sinh(thetao_oi[k, i] * T_ci/T), 2);
    double sum_cosh = no_oi[k, i] * std::pow(thetao_oi[k, i], 2) / std::pow(std::cosh(thetao_oi[k, i] * T_ci/T), 2);
    return R_R * (-no_oi[2, i] * std::pow(T/T_ci, 2) - sum_sinh - sum_cosh);
}

// Table B7
//     // a^r_ij(delta, tau) = sum_k(n_ij,k * delta^d_ij,k * tau^t_ij,k) + 
//     //                      sum_k(n_ij,k * delta^d_ij,k * tau^t_ij,k * exp[-eta_ij,k*(delta-eps_ij,k)^2 - beta_ij,k*(delta-j_ij,k)])
double GERG::ar_oi(int i) {
    double sum_pol = n_oi[k, i] * std::pow(delta, d_oi[k, i]) * std::pow(tau, t_oi[k, i]);
    double sum_exp = n_oi[k, i] * std::pow(delta, d_oi[k, i]) * std::pow(tau, t_oi[k, i]) * std::exp(-std::pow(delta, c_oi[k, i]));
    return sum_pol + sum_exp;
}
double GERG::dar_oi_dd(int i) {
    return;
}
double GERG::d2ar_oi_dd2(int i) {
    return;
}
double GERG::d2ar_oi_ddt(int i) {
    return;
}
double GERG::dar_oi_dt(int i) {
    return;
}
double GERG::d2ar_oi_dt2(int i) {
    return;
}

// Table B8
double GERG::ar_ij(int i, int j) {
    return;
}
double GERG::dar_ij_dd(int i, int j) {
    return;
}
double GERG::d2ar_ij_dd2(int i, int j) {
    return;
}
double GERG::d2ar_ij_ddt(int i, int j) {
    return;
}
double GERG::dar_ij_dt(int i, int j) {
    return;
}
double GERG::d2ar_ij_dt2(int i, int j) {
    return;
}

// Table B9
double GERG::Y(char y) {
    return;
}
double GERG::Y_x(char y, int i) {
    return;
}
double GERG::Y_xx(char y, int i, int j) {
    return;
}
double GERG::fki_x(char y, int i, int k) {
    return;
}
double GERG::fik_x(char y, int i, int k) {
    return;
}
double GERG::fki_xx(char y, int i, int k) {
    return;
}
double GERG::fik_xx(char y, int i, int k) {
    return;
}
double GERG::fij_xx(char y, int i, int j) {
    return;
}
*/
